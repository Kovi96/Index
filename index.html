<!DOCTYPE html>\n<html lang=\"ru\">\n<head>\n  <meta charset=\"utf-8\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"/>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"/>\n  <title>Kn — Индекс ITMEN (Partner Profit \u00a0v3)</title>\n  <style>\n    :root{--bg:#0b1020;--card:#0f1527;--muted:#f94ab3;--text: #e59ce8;--f237: #f237?;--mint:#10b981;--cyan:#22d3ee;--accent:#34d399}\n    {box-sizing:border-box}\n    body{margin:0;font-family:ui-sans-serif,system-ui,ui-apple-system,sans-serif,Noto Sans,Ubuntu Cantarell,Segoe UI,Roboto,Arial;background:#0b1020;color:var(--text);background:radial-gradient(1200px 800px at 10% 10%,#0b1020 80%),radial-gradient(800px 600px at 110% 10%, #f43f5e26, transparent 50%),linear-gradient(1200px 800px at 10% 50%,#ad5df4a3, #b2406a61);background-attachment:fixed;background-size:cover;position:relative;min-height:100vh}\n    .container{max-width:1200px;margin:32px auto;padding:0 16px;position:relative;z-index:1}\n    .ui-topright-logo{position:fixed;right:16px;top:12px;height:28px}\n    .ui-topright-logo img{height:28px}\n    header{display:flex;gap:12px;align-items:center;min-height:32px;margin:0}.sub{color:var(--muted);font-size:13px}\n    .grid{display:grid;grid-template-columns:1fr;gap:10px}.stats-wrapper{min-height:980px}.grid(grid-template-columns:1fr}\n    h2{font-size:15px;margin:0 0 10px} label{display:grid;gap:6px;font-size:12px;margin:0}\n    input,select,textarea{width:100%;padding:0 12px;border:1px solid #243843;background:#0b1022;color:var(--text)}\n    input:focus,select:focus,textarea:focus{outline:none;box-shadow:0 0 3px #08b91a33,border-color:#1203}\n    textarea{min-height:80px;resize:vertical}\n    .chips{display:flex;flex-wrap:wrap;gap:10px}.chip{border:1px solid #28d9f3;background:#0b1222;padding:10px 12px;border-radius:12px;display:flex;justify-content:center;align-items:center;text-decoration:none;color:var(--text);transition:background 0.2s ease}  .chip:hover{background:#10223c}.chip .close{margin-left:5px;font-size:14px;cursor:pointer;color:var(--muted)}  .chip .close:hover{color:var(--accent)}\n    .stat{display:grid;grid-template-columns:1fr;gap:10px}\n    .stat{background:linear-gradient(180deg,#0b1a33,#081a33),linear-gradient(0deg,#092d33,#23495e26);border-radius:14px;padding:12px}\n    .stat{color:var(--muted);font-size:12px;text-align:center}.mono{font-variant-numeric:tabular-nums}\n    .stat .profit{ background:#0e315f; border:2px solid #344d39; /* green border */ color:#34d399; padding:4px 8px; text-align:left; box-shadow:0 0 3px rgba(52,211,153,.25); border-radius:14px;}\n    .stat .profit .text{font-weight:700}.mono{font-variant-numeric:tabular-nums}\n    #profit-numerator, #profit-denominator { font-weight:600 }\n    .stat.profit .label { color:var(--muted);font-size:12px }.stat .mono{font-variant-numeric:tabular-nums}\n    .card{display:grid;gap:10px;padding:12px;background:#0b1222;border-radius:14px;border:2px solid #234843}\n    .card input,.card select,.card textarea{background:#0b1a2f;color:var(--text);border:1px solid #243843;padding:8px;border-radius:10px}\n    .card input:focus,.card select:focus,.card textarea:focus{outline:none;box-shadow:0 0 3px #08b91a33,border-color:#1203}\n    .row{grid-template-columns:1fr}.row2{grid-template-columns:repeat(2,1fr);gap:10px}.chips{display:flex;flex-wrap:wrap;gap:10px}.chip{display:flex;gap:10px;padding:10px 12px;border-radius:12px;background:#0b1222;border:1px solid #28d9f3;color:#fff;text-decoration:none;align-items:center}.chip:hover{background:#10223c}.chip .close{margin-left:5px;font-size:14px;cursor:pointer;color:#f94ab3}.chip .close:hover{color:#34d399}\n    button { padding: 8px 24px; border-radius: 8px; border: none; background: #2563eb; color: white; cursor: pointer; font-weight: bold; }\n    button:hover { background: #1d4ed8; }\n    table { width: 100%; border-collapse: collapse; margin: 16px 0; }\n    th, td { border: 1px solid #243843; padding: 8px; text-align: left; }\n    th { background: #0b1222; color: var(--muted); }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <header>\n      <svg class=\"ui-topright-logo\" viewBox=\"0 0 448 512\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" height=\"28\"><!-- ... truncated for brevity ... --></svg>\n      <h1>ROI-калькулятор (год) — только лицензии</h1>\n      <span class=\"sub\">Kn — Индекс ITMEN (Partner Profit \u00a0v3)</span>\n    </header>\n    <div class=\"grid\">\n      <label>\n        <span>Кол-во рабочих мест (PM)</span>\n        <input id=\"rm-count\" type=\"number\" placeholder=\"Введите кол-во PM\"/>\n      </label>\n      <label>\n        <span>Клиент</span>\n        <input id=\"client-name\" type=\"text\" placeholder=\"Введите название организации\"/>\n      </label>\n      <label>\n        <span>Лицензии (добавляй несколько)</span>\n        <div style=\"display:flex;gap:8px\">\n          <select id=\"license-type-select\" style=\"flex:1\">\n            <option value=\"windows_pro\">Microsoft Windows (Pro/Enterprise)</option>\n            <option value=\"office365\">Microsoft Office 365</option>\n            <option value=\"others\">Прочие</option>\n          </select>\n          <input id=\"license-count-input\" type=\"number\" placeholder=\"0\" style=\"width:80px\"/>\n          <button id=\"add-license\" type=\"button\">+ Добавить</button>\n        </div>\n      </label>\n    </div>\n    <h3>Лицензии</h3>\n    <table id=\"licenses-table\">\n      <thead>\n        <tr><th>Лицензия</th><th>Кол-во</th><th>Цена за 1/год</th><th>Итого/год</th><th></th></tr>\n      </thead>\n      <tbody></tbody>\n    </table>\n    <button id=\"calculate-roi\">Рассчитать ROI</button>\n    <div id=\"results\">\n      <div class=\"stat profit\"><span class=\"label\">Потенциал экономии (₽/год)</span> <span class=\"mono\" id=\"profit-amount\">0 ₽</span></div>\n      <div class=\"stat profit\"><span class=\"label\">ROI (%) / Окупаемость (лет)</span> <span class=\"mono\" id=\"roi-value\">0 % / 0</span></div>\n    </div>\n  </div>\n  <script>\nconst LEADS_ENDPOINT = 'https://script.google.com/macros/s/AKfycbzY0v3ZZ1TAzTneF4NRmrP4j8RD6vJ3s6dxVMeZmWYUza_N6ZvoW-kFnA63ybhYbU_ExQ/exec';\n\nconst licensePricing = {\n  windows_pro: 8000, // price per license per year\n  office365: 6000,\n  others: 5000\n};\n\nconst licenseNameMap = {\n  windows_pro: 'Microsoft Windows (Pro/Enterprise)',\n  office365: 'Microsoft Office 365',\n  others: 'Прочие'\n};\n\nconst addedLicenses = {};\n\nfunction updateLicensesTable() {\n  const tbody = document.getElementById('licenses-table').querySelector('tbody');\n  tbody.innerHTML = '';\n  Object.entries(addedLicenses).forEach(([key, count]) => {\n    const tr = document.createElement('tr');\n    const price = licensePricing[key];\n    const total = price * count;\n    tr.innerHTML = `\n      <td>${licenseNameMap[key]}</td>\n      <td>${count}</td>\n      <td>${price} ₽</td>\n      <td>${total.toLocaleString('ru-RU')} ₽</td>\n      <td><button data-key="${key}" class="remove-license">x</button></td>\n    `;\n    tbody.appendChild(tr);\n  });\n}\n\ndocument.getElementById('add-license').addEventListener('click', () => {\n  const type = document.getElementById('license-type-select').value;\n  const count = parseInt(document.getElementById('license-count-input').value, 10);\n  if (type && count > 0) {\n    addedLicenses[type] = (addedLicenses[type] || 0) + count;\n    updateLicensesTable();\n    document.getElementById('license-count-input').value = '';
  }
});

document.getElementById('licenses-table').addEventListener('click', (e) => {
  if (e.target.classList.contains('remove-license')) {
    const key = e.target.getAttribute('data-key');
    delete addedLicenses[key];
    updateLicensesTable();
  }
});

document.getElementById('calculate-roi').addEventListener('click', () => {
  const rmCount = parseInt(document.getElementById('rm-count').value, 10);
  if (!rmCount || rmCount <= 0) {
    alert('Введите корректное количество рабочих мест');
    return;
  }

  const totalLicenseCost = Object.entries(addedLicenses).reduce((sum, [key, count]) => sum + licensePricing[key] * count, 0);
  const potentialSavings = totalLicenseCost * 0.2; // 20% savings estimate

  const roiPercent = (potentialSavings / totalLicenseCost) * 100;
  const payback = (totalLicenseCost - potentialSavings) / potentialSavings;

  document.getElementById('profit-amount').innerText = `${potentialSavings.toLocaleString('ru-RU')} ₽`;
  document.getElementById('roi-value').innerText = `${roiPercent.toFixed(1)} % / ${payback.toFixed(1)}`;

  // Send leads
  const clientName = document.getElementById('client-name').value;
  const licenseList = Object.keys(addedLicenses).map(key => licenseNameMap[key]);
  const licenseAmounts = Object.values(addedLicenses);
  const data = {
    client: clientName,
    rmCount: rmCount,
    licenses: licenseList,
    licenseAmounts: licenseAmounts
  };
  fetch(LEADS_ENDPOINT, {
    method: 'POST',
    mode: 'no-cors',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(data)
  }).catch(err => console.error(err));
});
</script>
</body>
</html>
