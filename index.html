<!DOCTYPE html>

<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<title>–ö–ü ‚Äî –ò–Ω—Ñ–µ—Ä–∏—Ç –ò–¢–ú–µ–Ω (Partner Profit ¬∑ v3)</title>
<style>
:root{--bg:#0b1020;--card:#0f1527;--muted:#94a3b8;--text:#e5e7eb;--border:#1f2937;--mint:#10b981;--cyan:#22d3ee;--accent:#34d399}
*{box-sizing:border-box}
body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;background:#0b1020;color:var(--text);
background:radial-gradient(1200px 800px at 10% -10%, #0ea5e93a, transparent 60%),radial-gradient(800px 600px at 110% 10%, #f43f5e26, transparent 50%),linear-gradient(180deg,#0b1020,#0a0f1c)}
.container{max-width:1200px;margin:32px auto;padding:0 16px;position:relative}
.ui-topright-logo{position:fixed;right:16px;top:12px;z-index:20;opacity:.95}
.ui-topright-logo img{height:28px}
header{display:flex;gap:12px;align-items:center;margin-bottom:16px} h1{font-size:22px;margin:0} .sub{color:var(--muted);font-size:13px}
.grid{display:grid;grid-template-columns:1.05fr .95fr;gap:14px} @media(max-width:980px){.grid{grid-template-columns:1fr}}
.card{}
h2{font-size:15px;margin:0 0 10px} label{display:grid;gap:6px;font-size:13px}
.card input,.card select,.card textarea{width:100%;padding:12px;border-radius:12px;border:1px solid #243043;background:#0b1222;color:var(--text)}
.card input:focus,.card select:focus,.card textarea:focus{outline:none;box-shadow:0 0 0 3px #0891b233;border-color:#1e293b}
textarea{min-height:80px;resize:vertical} .row{display:grid;grid-template-columns:1fr 1fr;gap:10px} @media(max-width:800px){.row{grid-template-columns:1fr}}
.chips{display:flex;flex-wrap:wrap;gap:10px} .chip{border:1px solid #1f2937;background:#0b1222;padding:10px 12px;border-radius:12px;display:flex;justify-content:space-between;gap:12px;align-items:center;flex:1;cursor:pointer}
.chip h4{margin:0;font-size:13px} .muted{color:var(--muted);font-size:12px}
.kpi-wrap{display:grid;grid-template-columns:1fr;gap:10px}
.stat{background:linear-gradient(180deg,#0e1a33,#0b152b);border:1px solid #1f2937;border-radius:14px;padding:12px}
.stat .label{color:var(--muted);font-size:12px} .stat .value{font-size:20px;font-weight:700} .mono{font-variant-numeric:tabular-nums}

.stat.profit {
  background:#09351f;
  border:2px solid #34d399;   /* –∑–µ–ª—ë–Ω—ã–π –∫–æ–Ω—Ç—É—Ä */
  text-align:left;
  box-shadow:0 0 0 3px rgba(52,211,153,.25); /* –≤–Ω–µ—à–Ω–µ–µ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–Ω–∏–µ */
  border-radius:14px;
  padding:12px;
}
.stat.profit .label {
  color:#10b981;              /* —è—Ä–∫–∏–π –∑–µ–ª—ë–Ω—ã–π */
  font-weight:700;
}
.stat.profit .value {
  color:#10b981;
  font-size:22px;
  font-weight:900;
}

.stat.profit .label{color:#c7f7e4;font-size:12px;letter-spacing:.3px} .stat.profit .value{color:#6ee7b7;font-size:22px;font-weight:900}
.hr{height:1px;background:#1f2937;margin:12px -14px} .btns{display:flex;gap:10px;flex-wrap:wrap}
.btn{appearance:none;border:none;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:700;background:linear-gradient(90deg,var(--mint),var(--cyan));color:#0b1222}
table{width:100%;border-collapse:collapse;font-size:13px} th,td{padding:10px 8px;border-bottom:1px solid #1f2937;white-space:nowrap} th{text-align:left;color:#cbd5e1;font-weight:600} .right{text-align:right}
.small{font-size:12px;color:var(--muted)}

/* PDF */
.print-doc{position:fixed;left:-99999px;top:0;z-index:-1;opacity:0;pointer-events:none}
.a3page{width:2480px;height:1754px;position:relative;background:#fff;overflow:hidden;display:flex;flex-direction:column}
.page-bg{position:absolute;inset:0;background-repeat:no-repeat;background-position:center;background-size:100% auto;opacity:.04;filter:grayscale(100%);pointer-events:none}
.page-inner{position:relative;padding:22px 28px 40px 28px;display:flex;flex-direction:column;gap:14px;flex:1}
.p-header{display:flex;justify-content:space-between;align-items:center;gap:22px;padding:18px 20px;background:linear-gradient(90deg,#0f172a,#111827);border-radius:16px}
.p-title{color:#fff;font-weight:900;font-size:28px;letter-spacing:.2px}
.meta-grid{display:flex;flex-direction:column;align-items:flex-start;gap:8px;font-size:16px;color:#0f172a;padding:6px 8px}
.meta-grid div strong{color:#111827}
.kpis{display:grid;grid-template-columns:1fr;gap:10px;margin:0;border-radius:12px;padding:14px;background:#eafaf1;color:#065f46 margin: 8px 0 0 0; margin:2px 0 0 0; font-family:inherit;  border:2px solid #22c55e; border-radius:12px; padding:10px; background:#f0fdf4;  box-shadow:0 0 0 2px rgba(34,197,94,.15) inset; }
.kpi .label{font-size:13px;color:#065f46;letter-spacing:.3px font-family:inherit;  color:#047857; font-weight:700; } .kpi .value{font-size:28px;font-weight:900 font-family:inherit;  color:#059669; font-weight:900; }
.ptable{border:1px solid #e5e7eb;border-radius:12px;overflow:auto;background:#fff;width:100%;margin-top:0;padding-top:0}
.ptable th,.ptable td{border-bottom:1px solid #e5e7eb;padding:10px 10px;font-size:14px;color:#0f172a}
.ptable thead th{background:#f3f4f6;text-align:left;font-size:16px;font-weight:700}
.kpi-in-table td{padding:0;border-bottom:none;background:transparent}
.footer-note{position:absolute;left:0;right:0;bottom:22px;text-align:center;font-size:12px;color:#111827;letter-spacing:.5px}
.badge{display:inline-flex;gap:8px;align-items:center;background:#0b1222;border:1px solid #203046;border-radius:999px;padding:6px 10px;font-size:12px}

#pdfTableWrap{ margin-top:180px; }

/* KPI Block Strong Border + Glow */
#pdfTableWrap .kpi{
  border: 3px solid #34d399 !important;
  outline: 2px solid #065f46 !important;
  outline-offset: 2px;
  border-radius: 14px !important;
  box-shadow: 0 0 10px rgba(52, 211, 153, 0.9) !important;
  background: #f0fdf4 !important;
  padding: 12px !important;
}
.kpi .label, .kpi .value {
  color: #047857 !important;
  font-weight: 800 !important;
  text-shadow: 0 0 6px rgba(34,197,94,0.8);
}


.meta-grid{background:transparent!important;border:none!important;box-shadow:none!important;}

/* Discount toggles */
.discWrap{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.discInput{display:none}
.discInput.show{display:block}
.discWrap label{margin:0}
.hint{color:var(--muted, #94a3b8);font-size:12px;display:block;margin-top:6px;line-height:1.22}


/* Hide partner profit KPI unless partner discount is enabled */
body.hidePartnerProfit .stat.profit{display:none !important;}
/* Payment terms optional block */
#paymentTermsCard{
  display:none;
  margin-top:12px;
  padding-top:10px;
  border-top:1px solid rgba(0,0,0,0.08);
}
#paymentTermsCard.show{ display:block; }

/* ROI optional block */
#roiCard{ display:none; margin-top:12px; padding-top:10px; border-top:1px solid rgba(0,0,0,0.08); }
#roiCard.show{ display:block; }
.roiRow{ display:flex; gap:12px; align-items:flex-end; flex-wrap:wrap; }
.roiRow .stat{ flex:1; min-width:220px; }
.switchline{ display:flex; align-items:center; gap:10px; margin-top:10px; user-select:none; }
.switchline input{ transform: scale(1.1); }


@media print{
  *{ -webkit-print-color-adjust: exact; print-color-adjust: exact; }
}
</style>
<style id="kpi-border-patch">
/* Force visible green border/outline for KPI block in both screen and PDF */
#a4 .kpis,
#a4 .stat.profit,
.a3page .kpis,
.a3page .stat.profit,
#print .kpis,
#print .stat.profit,
#pdfTableWrap .kpis,
#pdfTableWrap .stat.profit {
  border:3px solid #22c55e !important;
  border-radius:14px !important;
  box-shadow:0 0 0 3px rgba(34,197,94,.25) inset, 0 0 0 1px rgba(34,197,94,.6) !important;
  background:#f0fdf4 !important;
}
#pdfTableWrap .kpi .label,
#pdfTableWrap .kpi .value,
.a3page .kpi .label,
.a3page .kpi .value {
  color:#047857 !important;
  font-weight:800 !important;
}
#pdfTableWrap .kpis { padding:10px !important; }

/* ROI optional block */
#roiCard{ display:none; margin-top:12px; padding-top:10px; border-top:1px solid rgba(0,0,0,0.08); }
#roiCard.show{ display:block; }
.roiRow{ display:flex; gap:12px; align-items:flex-end; flex-wrap:wrap; }
.roiRow .stat{ flex:1; min-width:220px; }
.switchline{ display:flex; align-items:center; gap:10px; margin-top:10px; user-select:none; }
.switchline input{ transform: scale(1.1); }


@media print{
  *{ -webkit-print-color-adjust: exact; print-color-adjust: exact; }
}
</style>
</head>
<body class="hidePartnerProfit">
<div class="ui-topright-logo"><img alt="–ò–Ω—Ñ–µ—Ä–∏—Ç" src="data:image/png;base64,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"/></div>
<div class="container">
<header>
<div>
<h1>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä ‚Äî –ò–Ω—Ñ–µ—Ä–∏—Ç –ò–¢–ú–µ–Ω</h1>
<div class="sub">–¢–æ—á–∫–∏ ‚Üí –ú–æ–¥—É–ª–∏ ‚Üí –¢–∏–ø –ª–∏—Ü–µ–Ω–∑–∏–∏ ‚Üí –¢–ü ‚Üí –°—Ç–æ–∏–º–æ—Å—Ç—å ‚Üí –ó–∞—Ä–∞–±–æ—Ç–æ–∫ –ø–∞—Ä—Ç–Ω—ë—Ä–∞</div>
</div>
</header>
<div class="card">
<div class="btns">
<button class="btn" id="btnPDF">–°–∫–∞—á–∞—Ç—å PDF</button>
</div>
<div class="small">–í—ã–≥—Ä—É–∑–∫–∞ PDF —Å KPI ¬´–ó–∞—Ä–∞–±–æ—Ç–æ–∫ –ø–∞—Ä—Ç–Ω—ë—Ä–∞¬ª (–≥–æ–¥ 1 –∏ 3 –≥–æ–¥–∞).</div>
</div>
<div class="grid">
<div class="card">
<h2>–í–≤–æ–¥–Ω—ã–µ</h2>
<div class="row">
<label>–ö–æ–ª-–≤–æ –∫–æ–Ω–µ—á–Ω—ã—Ö —Ç–æ—á–µ–∫
          <input id="endpoints" min="1" step="1" type="number" value="10000"/>
</label>
<label>–¢–∏–ø –ª–∏—Ü–µ–Ω–∑–∏–∏
          <select id="licenseType">
<option value="annual">–°—Ä–æ—á–Ω–∞—è (Annual)</option>
<option value="perpetual">–ë–µ—Å—Å—Ä–æ—á–Ω–∞—è (Perpetual)</option>
</select>
</label>
</div>
<div class="row" style="margin-top:10px">
<label>–¢–∞—Ä–∏—Ñ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∏
          <select id="supportTier"></select>
<span class="small">–¢–ü —Å—á–∏—Ç–∞–µ—Ç—Å—è –µ–∂–µ–≥–æ–¥–Ω–æ; —Å–∫–∏–¥–∫–∞ –ø–∞—Ä—Ç–Ω—ë—Ä–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è</span>
</label>
<label>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
          <input id="clientName" placeholder="–û–û–û ¬´–ü—Ä–æ–º—Ä–µ—Å—É—Ä—Å¬ª" type="text"/>
</label>
</div>
<div class="row" style="margin-top:10px">
<label>–ú–µ–Ω–µ–¥–∂–µ—Ä (–§–ò–û)
          <input id="managerName" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω" type="text"/>
</label>
<label>–¢–µ–ª–µ—Ñ–æ–Ω –º–µ–Ω–µ–¥–∂–µ—Ä–∞
          <input id="managerPhone" placeholder="+7 (999) 123-45-67" type="text"/>
</label>
</div>
<div class="row" style="margin-top:10px">

<label><span>–í–Ω–µ–¥—Ä–µ–Ω–∏–µ (—Ä–∞–∑–æ–≤—ã–π –ø–ª–∞—Ç—ë–∂)</span>
<div style="display:flex;align-items:center;gap:8px">
<input id="implOn" type="checkbox"/>
<span class="muted">500¬†000 ‚ÇΩ –±–µ–∑ –ù–î–° / 610¬†000 ‚ÇΩ —Å –ù–î–°</span>
</div>
</label>
<div class="field">
<div class="discWrap">
<input id="usePartnerDiscount" style="width:18px;height:18px" type="checkbox"/>
<label for="usePartnerDiscount">–ü—Ä–∏–º–µ–Ω—è—Ç—å –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫—É—é —Å–∫–∏–¥–∫—É</label>
</div>
<div class="discInput"><input id="partnerDiscount" max="100" min="0" step="1" type="number" value="0"/></div><div class="discInput" id="partnerNameWrap"><label>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Ç–Ω—ë—Ä–∞
          <input id="partnerName" placeholder="–û–û–û ¬´–ü–∞—Ä—Ç–Ω–µ—Ä –ì—Ä—É–ø–ø¬ª" type="text"/>
</label></div>
<small class="hint">–ü–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∞—è —Å–∫–∏–¥–∫–∞, % (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)</small></div>
</div>
<div class="row" style="margin-top:10px">
<label>–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ
          <input id="validUntil" type="date"/>
</label>
</div>
<div class="row">
<div class="field">
<div class="discWrap">
<input id="useModuleDiscount" style="width:18px;height:18px" type="checkbox"/>
<label for="useModuleDiscount">–ü—Ä–∏–º–µ–Ω—è—Ç—å —Å–∫–∏–¥–∫—É –º–æ–¥—É–ª–µ–π</label>
</div>
<div class="discInput"><input id="discModules" max="100" min="0" step="1" type="number" value="0"/></div>
<small class="hint">–°–∫–∏–¥–∫–∞ –º–æ–¥—É–ª–µ–π, % (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)</small></div>
</div>
<div class="row" style="margin-top:8px">
<div class="field"><div class="discWrap">
<input id="useSupportDiscount" style="width:18px;height:18px" type="checkbox"/>
<label for="useSupportDiscount">–ü—Ä–∏–º–µ–Ω—è—Ç—å —Å–∫–∏–¥–∫—É —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∏</label>
</div><div class="discInput"><input id="discSupport" max="100" min="0" step="1" type="number" value="0"/></div>
<small class="hint">–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ –≥–æ–¥–æ–≤–æ–º—É –∏—Ç–æ–≥—É –¢–ü (–≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö/–∏—Ç–æ–≥–∞—Ö)</small>
</div>
<div class="field"><div class="discWrap">
<input id="useImplDiscount" style="width:18px;height:18px" type="checkbox"/>
<label for="useImplDiscount">–ü—Ä–∏–º–µ–Ω—è—Ç—å —Å–∫–∏–¥–∫—É –≤–Ω–µ–¥—Ä–µ–Ω–∏—è</label>
</div><div class="discInput"><input id="discImpl" max="100" min="0" step="1" type="number" value="0"/></div>
<small class="hint">–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ —Ä–∞–∑–æ–≤–æ–º—É –≤–Ω–µ–¥—Ä–µ–Ω–∏—é (–≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö/–∏—Ç–æ–≥–∞—Ö)</small>
</div>
</div>
<div class="row" style="margin-top:6px">
<div class="field"><small class="hint" id="supportAfterHint"></small></div>
<div class="field"><small class="hint" id="implAfterHint"></small></div>
</div>
<div class="hr"></div>
<label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
        <textarea id="comment" placeholder="–î–æ–ø. —É—Å–ª–æ–≤–∏—è, –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Å—Å—ã–ª–∫–∏ –∏ —Ç.–¥."></textarea>
</label>
<div class="hr"></div>
<h2>–ú–æ–¥—É–ª–∏</h2>
<div class="chips" id="modules"></div>
<div class="hr"></div>
<div class="badge">–≠—Ñ—Ñ–µ–∫—Ç—ã:
<label class="switchline"><input type="checkbox" id="showROI">–ü–æ–∫–∞–∑–∞—Ç—å ROI (–æ—Ü–µ–Ω–∫–∞ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏)</label>
<div id="roiCard">
  <div class="roiRow">
    <div class="stat roi">
      <div class="label">–†–∞—Å—á—ë—Ç –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏</div>
      <div class="value mono" id="kpiROI">‚Äî</div>
      <div class="muted">–°—á–∏—Ç–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç —á–∏—Å–ª–∞ –∫–æ–Ω–µ—á–Ω—ã—Ö —Ç–æ—á–µ–∫, –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π –∏ —Ç–∏–ø–∞ –ª–∏—Ü–µ–Ω–∑–∏–∏.</div>
    </div>
  </div>
</div>
 –¥–æ 25% –ª–∏—Ü–µ–Ω–∑–∏–∏ ¬∑ –¥–æ 30% –ò–¢-–∞–∫—Ç–∏–≤—ã ¬∑ –¥–æ 40% —Ä—É—á–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã ¬∑ –¥–æ 10% –ò–¢-–ø–µ—Ä—Å–æ–Ω–∞–ª</div>
</div>
<div class="card">
<h2>–ò—Ç–æ–≥–∏ (—Å—Ç–æ–∏–º–æ—Å—Ç—å)</h2>
<div class="kpi-wrap">
<div class="stat">
<div class="label">–°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ (—Å –ù–î–°)</div>
<div class="value mono" id="kpiCost">‚Äî</div>
<div class="muted" id="kpiCostNote">–£—á—Ç–µ–Ω—ã –º–æ–¥—É–ª–∏, –¢–ü, –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∏ –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∞—è —Å–∫–∏–¥–∫–∞</div>
</div>
<div class="stat">
<div class="label">–ì–æ–¥–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</div>
<div class="value mono" id="supportCost">‚Äî</div>
</div>
<div class="stat profit">
<div class="label">–ó–∞—Ä–∞–±–æ—Ç–æ–∫ –ø–∞—Ä—Ç–Ω—ë—Ä–∞</div>
<div class="value mono" id="kpiPartnerProfit">–ì–æ–¥ 1: ‚Äî ¬∑ 3 –≥–æ–¥–∞: ‚Äî</div>
<div class="muted">–ë–µ—Å—Å—Ä–æ—á–Ω–∞—è –ª–∏—Ü–µ–Ω–∑–∏—è: –≤ –≥–æ–¥–∞—Ö 2‚Äì3 —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¢–ü. –°—Ä–æ—á–Ω–∞—è: –ª–∏—Ü–µ–Ω–∑–∏—è+–¢–ü –µ–∂–µ–≥–æ–¥–Ω–æ (–≤–Ω–µ–¥—Ä–µ–Ω–∏–µ ‚Äî —Ä–∞–∑–æ–≤–æ).</div>
</div>
<!-- –£—Å–ª–æ–≤–∏—è –æ–ø–ª–∞—Ç—ã (–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏) -->
<label class="switchline" style="margin-top:10px">
  <input type="checkbox" id="showPaymentTerms">
  –ü–æ–∫–∞–∑–∞—Ç—å —É—Å–ª–æ–≤–∏—è –æ–ø–ª–∞—Ç—ã
</label>

<div id="paymentTermsCard">
  <div class="row" style="margin-top:10px">
    <label>üì¶ –û—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω–∞—è –¥–∞—Ç–∞ –æ—Ç–≥—Ä—É–∑–∫–∏
      <input id="shipDate" type="date"/>
    </label>

    <label>üí≥ –£—Å–ª–æ–≤–∏—è –æ–ø–ª–∞—Ç—ã (–æ—Ç—Å—Ä–æ—á–∫–∞)
      <select id="payDelay">
        <option value="5">5 –¥–Ω–µ–π</option>
        <option value="30" selected>30 –¥–Ω–µ–π</option>
        <option value="45">45 –¥–Ω–µ–π</option>
      </select>
      <span class="small">–î–µ–Ω—å –æ–ø–ª–∞—Ç—ã —Å—á–∏—Ç–∞–µ—Ç—Å—è –æ—Ç –¥–∞—Ç—ã –æ—Ç–≥—Ä—É–∑–∫–∏.</span>
    </label>
  </div>

  <div class="row" style="margin-top:10px">
    <div class="stat">
      <div class="label">üßæ –û–∂–∏–¥–∞–µ–º–∞—è –¥–∞—Ç–∞ –æ–ø–ª–∞—Ç—ã</div>
      <div class="value mono" id="expectedPayDate">‚Äî</div>
      <div class="muted">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: –æ—Ç–≥—Ä—É–∑–∫–∞ + –æ—Ç—Å—Ä–æ—á–∫–∞</div>
    </div>

    <div class="stat">
      <div class="label">–°—Ä–æ–∫ –æ–ø–ª–∞—Ç—ã</div>
      <div class="value mono" id="payTermText">‚Äî</div>
      <div class="muted">–ù–∞–ø—Ä–∏–º–µ—Ä: ‚Äú–û—Ç—Å—Ä–æ—á–∫–∞ 30 –¥–Ω–µ–π‚Äù</div>
    </div>
  </div>
</div>
</div>
</div>
</div>
<div class="card" style="margin-top:14px">
<h2>–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏</h2>
<div class="hr"></div>
<div style="overflow:auto">
<table id="itemsTable">
<thead>
<tr>
<th>–ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞</th>
<th>–ê—Ä—Ç–∏–∫—É–ª</th>
<th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</th>
<th class="right">–ö–æ–ª-–≤–æ</th>
<th class="right">–¶–µ–Ω–∞ (–∑–∞ –µ–¥.)</th>
<th class="right">–°–∫–∏–¥–∫–∞</th>
<th class="right">–°—É–º–º–∞ –±–µ–∑ –ù–î–°</th>
<th class="right">–°—É–º–º–∞ —Å –ù–î–°</th>
            <th class="right partnerUnitCol">–ü–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∞—è —Ü–µ–Ω–∞ (–∑–∞ –µ–¥.)</th>
</tr>
</thead>
<tbody id="itemsTbody"></tbody>
<tfoot>
<tr>
<th class="right" colspan="5">–ò—Ç–æ–≥–æ –±–µ–∑ –ù–î–°</th>
<th class="right" id="sumNoVAT">‚Äî</th>
<th></th>
<th class="right">–ò—Ç–æ–≥–æ –ø–∞—Ä—Ç–Ω—ë—Ä –±–µ–∑ –ù–î–°</th>
<th class="right" id="sumNoVATPartner">‚Äî</th>
<th></th>
</tr>
<tr>
<th class="right" colspan="6">–ò—Ç–æ–≥–æ —Å –ù–î–°</th>
<th class="right" id="sumWithVAT">‚Äî</th>
<th class="right">–ò—Ç–æ–≥–æ –ø–∞—Ä—Ç–Ω—ë—Ä —Å –ù–î–°</th>
<th></th>
<th class="right" id="sumWithVATPartner">‚Äî</th>
</tr>
</tfoot>
</table>
</div>
</div>
</div>
<div class="print-doc" id="printDoc"></div>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<script>
// --- Partner discount PIN gate (lightweight protection) ---
// NOTE: This is a UI guard only. In a single-file HTML, the PIN can be found in the source by a determined user.
const PARTNER_PIN = '1234'; // <-- change to your code
function requirePartnerPin(){const entered = prompt('–í–≤–µ–¥–∏—Ç–µ PIN-–∫–æ–¥ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–æ–π —Å–∫–∏–¥–∫–∏:');
  if (entered === null) return false;
  if (String(entered).trim() === PARTNER_PIN){return true;
  }
  alert('–ù–µ–≤–µ—Ä–Ω—ã–π PIN-–∫–æ–¥. –ü–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∞—è —Å–∫–∏–¥–∫–∞ –Ω–µ –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∞.');
  return false;
}


// Additional PIN-gates for other discounts (each time the checkbox is turned ON)
const SUPPORT_PIN = '1379'; // –¢–ü
const MODULES_PIN = '2517'; // –ú–æ–¥—É–ª–∏
const IMPL_PIN    = '3387'; // –í–Ω–µ–¥—Ä–µ–Ω–∏–µ

function requireSupportPin(){
  const entered = prompt('–í–≤–µ–¥–∏—Ç–µ PIN-–∫–æ–¥ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å–∫–∏–¥–∫–∏ –Ω–∞ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫—É:');
  if (entered === null) return false;
  if (String(entered).trim() === SUPPORT_PIN) return true;
  alert('–ù–µ–≤–µ—Ä–Ω—ã–π PIN-–∫–æ–¥. –°–∫–∏–¥–∫–∞ –Ω–∞ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫—É –Ω–µ –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∞.');
  return false;
}
function requireModulesPin(){
  const entered = prompt('–í–≤–µ–¥–∏—Ç–µ PIN-–∫–æ–¥ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å–∫–∏–¥–∫–∏ –Ω–∞ –º–æ–¥—É–ª–∏:');
  if (entered === null) return false;
  if (String(entered).trim() === MODULES_PIN) return true;
  alert('–ù–µ–≤–µ—Ä–Ω—ã–π PIN-–∫–æ–¥. –°–∫–∏–¥–∫–∞ –Ω–∞ –º–æ–¥—É–ª–∏ –Ω–µ –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∞.');
  return false;
}
function requireImplPin(){
  const entered = prompt('–í–≤–µ–¥–∏—Ç–µ PIN-–∫–æ–¥ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å–∫–∏–¥–∫–∏ –Ω–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ:');
  if (entered === null) return false;
  if (String(entered).trim() === IMPL_PIN) return true;
  alert('–ù–µ–≤–µ—Ä–Ω—ã–π PIN-–∫–æ–¥. –°–∫–∏–¥–∫–∞ –Ω–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –Ω–µ –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∞.');
  return false;
}

function enforceOtherDiscountPinGates(){
  const map = [
    { cb:'useSupportDiscount', input:'discSupport', ask: requireSupportPin },
    { cb:'useModuleDiscount',  input:'discModules', ask: requireModulesPin },
    { cb:'useImplDiscount',    input:'discImpl',    ask: requireImplPin },
  ];

  map.forEach(({cb,input,ask})=>{
    const el = document.getElementById(cb);
    if(!el) return;
    el.addEventListener('change', ()=>{
      if(el.checked){
        const ok = ask();
        if(!ok){
          el.checked = false;
          try{ toggleSimple(cb, input); }catch(err){}
          try{ recalc(); }catch(err){}
        }
      }
    });
  });
}


function clampPct(v){v=parseFloat(v||'0');if(isNaN(v))v=0;v=Math.max(0,Math.min(100,v));return v/100;}



function getDisc(inputId, checkboxId){
  const cb = document.getElementById(checkboxId);
  if (cb && !cb.checked) return 0;
  return clampPct(document.getElementById(inputId)?.value);
}
function syncDiscountUI(){
  const pairs = [
    ['usePartnerDiscount','partnerDiscount'],
    ['useModuleDiscount','discModules'],
    ['useSupportDiscount','discSupport'],
    ['useImplDiscount','discImpl'],
  ];
  pairs.forEach(([cbId, inputId]) => {
    const cb = document.getElementById(cbId);
    const input = document.getElementById(inputId);
    if (!cb || !input) return;
    const box = input.closest('.discInput');
    if (box) box.classList.toggle('show', cb.checked);
  });
}
const VAT = 0.22;

// ROI baselines (–∏–∑ —Å—Ç–∞—Ä–æ–≥–æ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞)
const BASELINES={"100-5000":{lic:4000,assets:6000,manual:2800,staff:3500},"5001-25000":{lic:3700,assets:5600,manual:2600,staff:3300},"25001-50000":{lic:3400,assets:5200,manual:2400,staff:3100},"50001+":{lic:3000,assets:4800,manual:2200,staff:2900}};
const ROI_PCT={lic:0.25,assets:0.30,manual:0.40,staff:0.10};
const ROI_FACTOR={annual:1.2,perpetual:3.2};

function getRangeROI(endpoints){
  if (endpoints <= 5000) return "100-5000";
  if (endpoints <= 25000) return "5001-25000";
  if (endpoints <= 50000) return "25001-50000";
  return "50001+";
}
function roiHiddenSavings(endpoints, licenseType, selectedModsCount){
  const r=getRangeROI(endpoints);
  const b=BASELINES[r];
  if (!b) return 0;
  const factor = (licenseType === 'annual') ? ROI_FACTOR.annual : ROI_FACTOR.perpetual;
  const totalMods = (typeof MODULE_LIST !== 'undefined' && MODULE_LIST.length) ? MODULE_LIST.length : 1;
  const modShare = Math.max(0.33, selectedModsCount / Math.max(1,totalMods));
  const baseLic=b.lic*endpoints, baseAssets=b.assets*endpoints, baseManual=b.manual*endpoints, baseStaff=b.staff*endpoints;
  return baseLic*ROI_PCT.lic*factor*modShare
       + baseAssets*ROI_PCT.assets*factor*modShare
       + baseManual*ROI_PCT.manual*factor*modShare
       + baseStaff*ROI_PCT.staff*factor*modShare;
}
function updateROI(totals){
  const cb=document.getElementById('showROI');
  const card=document.getElementById('roiCard');
  const out=document.getElementById('kpiROI');
  if(!cb || !card || !out) return;

  if(!cb.checked){
    card.classList.remove('show');
    out.textContent='‚Äî';
    return;
  }
  card.classList.add('show');

  const endpoints=parseInt(document.getElementById('endpoints')?.value||'0',10) || 0;
  const licenseType=document.getElementById('licenseType')?.value || 'annual';
  const selectedModsCount=document.querySelectorAll('#modules .chip[data-active="1"]').length;

  const cost = (totals && typeof totals.sumWithVAT === 'number') ? totals.sumWithVAT : 0;
  const savings = roiHiddenSavings(endpoints, licenseType, selectedModsCount);
  const roi = cost>0 ? (savings - cost) / cost : 0;
  out.textContent = '–¥–æ ' + (roi*100).toFixed(1).replace('.',',') + '%';
}

// –ü—Ä–∞–π—Å (—É—Å–µ—á—ë–Ω)
const PRICING = {
  items: {
    "–ë–∞–∑–æ–≤—ã–π": {
      annual: { per_endpoint: {"100-5000":{price:700,sku:"ITM-DISC-12-BASIC-100-5000"},"5001-25000":{price:630,sku:"ITM-DISC-12-BASIC-5001-25000"},"25001-50000":{price:570,sku:"ITM-DISC-12-BASIC-25001-50000"}}, unlim: {price:52631580, sku:"ITM-DISC-12-LIC-UNLIM-50001+"} },
      perpetual: { per_endpoint: {"100-5000":{price:2105,sku:"ITM-DISC-0-BASIC-100-5000"},"5001-25000":{price:1895,sku:"ITM-DISC-0-BASIC-5001-25000"},"25001-50000":{price:1700,sku:"ITM-DISC-0-BASIC-25001-50000"}}, unlim: {price:136000000, sku:"ITM-DISC-0-LIC-UNLIM-50001+"} }
    },
    "–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö": {
      annual: { per_endpoint: {"100-5000":{price:175,sku:"ITM-DISC-12-ADD-DATA-100-5000"},"5001-25000":{price:160,sku:"ITM-DISC-12-ADD-DATA-5001-25000"},"25001-50000":{price:140,sku:"ITM-DISC-12-ADD-DATA-25001-50000"}}, unlim: {price:12280700, sku:"ITM-DISC-12-ADD-DATA-50001+"} },
      perpetual: { per_endpoint: {"100-5000":{price:525,sku:"ITM-DISC-0-ADD-DATA-100-5000"},"5001-25000":{price:475,sku:"ITM-DISC-0-ADD-DATA-5001-25000"},"25001-50000":{price:425,sku:"ITM-DISC-0-ADD-DATA-25001-50000"}}, unlim: {price:34000000, sku:"ITM-DISC-0-ADD-DATA-50001+"} }
    },
    "–û–±–æ–≥–∞—â–µ–Ω–∏–µ –ü–û": {
      annual: { per_endpoint: {"100-5000":{price:175,sku:"ITM-DISC-12-ADD-SOFT-100-5000"},"5001-25000":{price:160,sku:"ITM-DISC-12-ADD-SOFT-5001-25000"},"25001-50000":{price:140,sku:"ITM-DISC-12-ADD-SOFT-25001-50000"}}, unlim: {price:12280700, sku:"ITM-DISC-12-ADD-SOFT-50001+"} },
      perpetual: { per_endpoint: {"100-5000":{price:525,sku:"ITM-DISC-0-ADD-SOFT-100-5000"},"5001-25000":{price:475,sku:"ITM-DISC-0-ADD-SOFT-5001-25000"},"25001-50000":{price:425,sku:"ITM-DISC-0-ADD-SOFT-25001-50000"}}, unlim: {price:34000000, sku:"ITM-DISC-0-ADD-SOFT-50001+"} }
    }
  },
  support: {
    "Support: –ì–∞—Ä–∞–Ω—Ç–∏–π–Ω–∞—è": {"100-5000":{price:0,sku:"ITM-DISC-12-TS-GRT-100-5000"},"5001-25000":{price:0,sku:"ITM-DISC-12-TS-GRT-5001-25000"},"25001-50000":{price:0,sku:"ITM-DISC-12-TS-GRT-25001-50000"}},
    "Support: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è": {"100-5000":{price:350,sku:"ITM-DISC-12-TS-STD-100-5000"},"5001-25000":{price:335,sku:"ITM-DISC-12-TS-STD-5001-25000"},"25001-50000":{price:285,sku:"ITM-DISC-12-TS-STD-25001-50000"}},
    "Support: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è": {"100-5000":{price:545,sku:"ITM-DISC-12-TS-EXT-100-5000"},"5001-25000":{price:490,sku:"ITM-DISC-12-TS-EXT-5001-25000"},"25001-50000":{price:425,sku:"ITM-DISC-12-TS-EXT-25001-50000"}}
  }
};

const MODULE_LIST = ["–ë–∞–∑–æ–≤—ã–π","–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö","–û–±–æ–≥–∞—â–µ–Ω–∏–µ –ü–û"];

function initModules() {
  const el = document.getElementById('modules');
  el.innerHTML = '';
  MODULE_LIST.forEach(name => {
    const chip = document.createElement('div');
    chip.className = 'chip';
    chip.dataset.active = '1'; // –≤–∫–ª—é—á–µ–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    chip.innerHTML = '<h4>'+name+'</h4><span class="muted">–≤–∫–ª</span>';
    chip.onclick = ()=>{
      const a = chip.dataset.active === '1' ? '0' : '1';
      chip.dataset.active = a;
      chip.querySelector('.muted').textContent = a==='1' ? '–≤–∫–ª' : '–≤—ã–∫–ª';
      recalc();
    };
    el.appendChild(chip);
  });
}

function fillSupportTiers() {
  const sel = document.getElementById('supportTier');
  sel.innerHTML = '';
  Object.keys(PRICING.support).forEach(k=>{
    const o = document.createElement('option');
    o.value = k;
    o.textContent = k;
    sel.appendChild(o);
  });
  sel.value = "Support: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è";
}

function getRange(endpoints) {
  if (endpoints <= 5000) return "100-5000";
  if (endpoints <= 25000) return "5001-25000";
  return "25001-50000";
}

function fmt(n){return (n||0).toLocaleString('ru-RU')+' ‚ÇΩ'}

function buildItems() {
  const endpoints = parseInt(document.getElementById('endpoints').value||'0',10);
  const licenseType = document.getElementById('licenseType').value;
  const supportTier = document.getElementById('supportTier').value;
  const range = getRange(endpoints);
  const items = [];

  // –õ–∏—Ü–µ–Ω–∑–∏–∏ ‚Äî —Ü–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É (endpoint), qty=endpoints (–∏–ª–∏ 1 –µ—Å–ª–∏ unlim)
  document.querySelectorAll('#modules .chip').forEach(ch => {
    if (ch.dataset.active !== '1') return;
    const name = ch.querySelector('h4').textContent;
    const cfg = PRICING.items[name][licenseType];
    if (!cfg) return;
    let unitPrice = 0, sku = '', qty = 1;
    if (endpoints > 50000) {
      unitPrice = cfg.unlim.price; sku = cfg.unlim.sku; qty = 1;
    } else {
      unitPrice = cfg.per_endpoint[range].price; sku = cfg.per_endpoint[range].sku; qty = endpoints;
    }
    items.push({
      group:'license', nomen:name, sku:sku, name:name+' ‚Äî '+(licenseType==='annual'?'–°—Ä–æ—á–Ω–∞—è':'–ë–µ—Å—Å—Ä–æ—á–Ω–∞—è'),
      qty:qty, unitPrice:unitPrice, vatApplies:false
    });
  });

  // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ‚Äî —Ü–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É (endpoint), qty=endpoints
  if (supportTier) {
    const scfg = PRICING.support[supportTier][range];
    const supUnitPrice = scfg.price;
    const supQty = endpoints;
    items.push({
      group:'support', nomen:'–¢–ü', sku:scfg.sku, name:supportTier,
      qty:supQty, unitPrice:supUnitPrice, vatApplies:true
    });
  }

  // –í–Ω–µ–¥—Ä–µ–Ω–∏–µ
  if (document.getElementById('implOn').checked) {
    items.push({
      group:'impl', nomen:'–í–Ω–µ–¥—Ä–µ–Ω–∏–µ', sku:'ITM-DISC-BASIC-DPLM', name:'–í–Ω–µ–¥—Ä–µ–Ω–∏–µ (—Ä–∞–∑–æ–≤–æ)',
      qty:1, unitPrice:500000, vatApplies:true, noteVATIncluded:600000
    });
  }

  return items;
}

function computeTotals(items) {
  const discPct = getDisc('partnerDiscount','usePartnerDiscount');
  const dMod = getDisc('discModules','useModuleDiscount');
  const dSup = getDisc('discSupport','useSupportDiscount');
  const dImp = getDisc('discImpl','useImplDiscount');
  let sumNoVAT = 0, sumWithVAT = 0, sumNoVATPartner = 0, sumWithVATPartner = 0;
  let supportFullNoVAT = 0, supportFullWithVAT = 0, supportPartnerNoVAT = 0, supportPartnerWithVAT = 0;
  let implFullNoVAT = 0, implFullWithVAT = 0, implPartnerNoVAT = 0, implPartnerWithVAT = 0;

  items.forEach(it => {
    const effUnit = it.group === 'license' ? it.unitPrice * (1 - dMod) : it.unitPrice;
    const subtotal = effUnit * it.qty;
    const partnerUnit = it.group === 'impl' ? effUnit : effUnit * (1 - discPct);
    const partnerSubtotal = partnerUnit * it.qty;

    const vat = it.vatApplies ? subtotal * VAT : 0;
    const vatPartner = it.vatApplies ? partnerSubtotal * VAT : 0;

    sumNoVAT += subtotal;
    sumWithVAT += subtotal + vat;
    sumNoVATPartner += partnerSubtotal;
    sumWithVATPartner += partnerSubtotal + vatPartner;

    if (it.group === 'support') {
      supportFullNoVAT += subtotal;
      supportFullWithVAT += subtotal + vat;
      supportPartnerNoVAT += partnerSubtotal;
      supportPartnerWithVAT += partnerSubtotal + vatPartner;
    }
    if (it.group === 'impl') {
      implFullNoVAT += subtotal;
      implFullWithVAT += subtotal + vat;
      implPartnerNoVAT += partnerSubtotal;
      implPartnerWithVAT += partnerSubtotal + vatPartner;
    }
  });

  // Variant A: –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Å–∫–∏–¥–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ –∞–≥—Ä–µ–≥–∞—Ç–∞–º (–∫–∞—Ä—Ç–æ—á–∫–∏/–∏—Ç–æ–≥–∏), —Å—Ç—Ä–æ–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –Ω–µ –º–µ–Ω—è–µ–º
  const supportFullNoVATAfter = supportFullNoVAT * (1 - dSup);
  const supportFullWithVATAfter = supportFullWithVAT * (1 - dSup);
  const supportPartnerNoVATAfter = supportPartnerNoVAT * (1 - dSup);
  const supportPartnerWithVATAfter = supportPartnerWithVAT * (1 - dSup);

  const implFullNoVATAfter = implFullNoVAT * (1 - dImp);
  const implFullWithVATAfter = implFullWithVAT * (1 - dImp);
  const implPartnerNoVATAfter = implPartnerNoVAT * (1 - dImp);
  const implPartnerWithVATAfter = implPartnerWithVAT * (1 - dImp);

  // —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –æ–±—â–∏–µ —Å—É–º–º—ã (–≤–∞–∂–Ω–æ: –Ω–µ —Ç—Ä–æ–≥–∞–µ–º —Å—Ç—Ä–æ–∫–∏)
  sumNoVAT = sumNoVAT - supportFullNoVAT - implFullNoVAT + supportFullNoVATAfter + implFullNoVATAfter;
  sumWithVAT = sumWithVAT - supportFullWithVAT - implFullWithVAT + supportFullWithVATAfter + implFullWithVATAfter;
  sumNoVATPartner = sumNoVATPartner - supportPartnerNoVAT - implPartnerNoVAT + supportPartnerNoVATAfter + implPartnerNoVATAfter;
  sumWithVATPartner = sumWithVATPartner - supportPartnerWithVAT - implPartnerWithVAT + supportPartnerWithVATAfter + implPartnerWithVATAfter;

  // –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ–º –∞–≥—Ä–µ–≥–∞—Ç—ã –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫
  supportFullWithVAT = supportFullWithVATAfter;
  supportPartnerWithVAT = supportPartnerWithVATAfter;
  implFullWithVAT = implFullWithVATAfter;
  implPartnerWithVAT = implPartnerWithVATAfter;

  return {
    sumNoVAT, sumWithVAT, sumNoVATPartner, sumWithVATPartner,
    supportFullWithVAT, supportPartnerWithVAT,
    implFullWithVAT, implPartnerWithVAT
  };
}


function renderTable(items, totals) {
  const table = document.getElementById('itemsTable');
  const tbody = document.getElementById('itemsTbody');

  // Flags: –∫–∞–∫–∏–µ —Å–∫–∏–¥–∫–∏ –∞–∫—Ç–∏–≤–Ω—ã (—á–µ–∫–±–æ–∫—Å—ã), —á—Ç–æ–±—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å/—Å–∫—Ä—ã–≤–∞—Ç—å –¥–æ–ø. –∫–æ–ª–æ–Ω–∫–∏
  const usePartner = !!document.getElementById('usePartnerDiscount')?.checked;
  const useMod = !!document.getElementById('useModuleDiscount')?.checked;
  const useSup = !!document.getElementById('useSupportDiscount')?.checked;
  const useImp = !!document.getElementById('useImplDiscount')?.checked;

  const discPct = getDisc('partnerDiscount','usePartnerDiscount');
  const dMod = getDisc('discModules','useModuleDiscount');
  const dSup = getDisc('discSupport','useSupportDiscount');
  const dImp = getDisc('discImpl','useImplDiscount');

  // –¢–∞–±–ª–∏—Ü–∞: —Ñ–∏–∫—Å–∏—Ä—É–µ–º –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –Ω–∞–±–æ—Ä –∫–æ–ª–æ–Ω–æ–∫, —á—Ç–æ–±—ã –≤—Å—ë –≤–ª–µ–∑–∞–ª–æ –≤ PDF –∏ –Ω–∞ —ç–∫—Ä–∞–Ω
  // –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ:
  // –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞ | –ê—Ä—Ç–∏–∫—É–ª | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ | –ö–æ–ª-–≤–æ | –¶–µ–Ω–∞ (–∑–∞ –µ–¥.) | –°–∫–∏–¥–∫–∞ | –°—É–º–º–∞ –±–µ–∑ –ù–î–° | –°—É–º–º–∞ —Å –ù–î–°
  const cols = [
    {k:'nomen', label:'–ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞', cls:''},
    {k:'sku', label:'–ê—Ä—Ç–∏–∫—É–ª', cls:''},
    {k:'name', label:'–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ', cls:''},
    {k:'qty', label:'–ö–æ–ª-–≤–æ', cls:'right'},
    {k:'unit', label:'–¶–µ–Ω–∞ (–∑–∞ –µ–¥.)', cls:'right'},
    {k:'disc', label:'–°–∫–∏–¥–∫–∞', cls:'right'},
    {k:'noVat', label:'–°—É–º–º–∞ –±–µ–∑ –ù–î–°', cls:'right'},
    {k:'withVat', label:'–°—É–º–º–∞ —Å –ù–î–°', cls:'right'},
  ];

  // –î–æ–±–∞–≤–ª—è–µ–º –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–æ–π —Å–∫–∏–¥–∫–µ
  // –°—Ç–∞–≤–∏–º –≤ –ö–û–ù–ï–¶, —á—Ç–æ–±—ã –≤ PDF –±—ã–ª–æ —á–∏—Ç–∞–µ–º–æ:
  // –ü–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∞—è —Ü–µ–Ω–∞ (–∑–∞ –µ–¥.) | –ü–∞—Ä—Ç–Ω—ë—Ä: —Å—É–º–º–∞ –±–µ–∑ –ù–î–° | –ü–∞—Ä—Ç–Ω—ë—Ä: —Å—É–º–º–∞ —Å –ù–î–°
  if (usePartner) {
    cols.push({k:'punit', label:'–ü–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∞—è —Ü–µ–Ω–∞ (–∑–∞ –µ–¥.)', cls:'right'});
    cols.push({k:'pNoVat', label:'–ü–∞—Ä—Ç–Ω—ë—Ä: —Å—É–º–º–∞ –±–µ–∑ –ù–î–°', cls:'right'});
    cols.push({k:'pWithVat', label:'–ü–∞—Ä—Ç–Ω—ë—Ä: —Å—É–º–º–∞ —Å –ù–î–°', cls:'right'});
  }

  // –ü–µ—Ä–µ—Ä–∏—Å—É–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
  if (table.tHead) {
    table.tHead.innerHTML = '<tr>' + cols.map(c => `<th class="${c.cls||''}">${c.label}</th>`).join('') + '</tr>';
  }

  // –ü–µ—Ä–µ—Ä–∏—Å—É–µ–º —Ç–µ–ª–æ
  tbody.innerHTML = '';

  items.forEach(it => {
    // unit for customer: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –±–∞–∑–æ–≤—É—é —Ü–µ–Ω—É –∑–∞ –µ–¥–∏–Ω–∏—Ü—É
    const unitBase = it.unitPrice;

    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–∫–∏–¥–∫—É, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∏–º–µ–Ω–Ω–æ –∫ —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–µ (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≥—Ä—É–ø–ø—ã)
    let lineDisc = 0;
    if (useMod && it.group === 'license') lineDisc = dMod;
    if (useSup && it.group === 'support') lineDisc = dSup;
    if (useImp && it.group === 'impl') lineDisc = dImp;

    // –¶–µ–Ω–∞/—Å—É–º–º–∞ –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ–π —Å–∫–∏–¥–∫–∏ (—Ç–æ–ª—å–∫–æ –∫ —Å–≤–æ–µ–π —Å—Ç—Ä–æ–∫–µ)
    const effUnit = unitBase * (1 - lineDisc);
    const subtotal = effUnit * it.qty;
    const vat = it.vatApplies ? subtotal * VAT : 0;
    const withVat = subtotal + vat;

    // –ü–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (–ø–æ—è–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞ –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∞—è —Å–∫–∏–¥–∫–∞)
    const partnerUnit = usePartner ? (it.group === 'impl' ? effUnit : effUnit * (1 - discPct)) : 0;
    const partnerSubtotal = usePartner ? partnerUnit * it.qty : 0;
    const partnerVat = (usePartner && it.vatApplies) ? partnerSubtotal * VAT : 0;
    const partnerWithVat = usePartner ? (partnerSubtotal + partnerVat) : 0;


    const row = {
      nomen: it.nomen,
      sku: it.sku,
      name: it.name,
      qty: it.qty,
      unit: fmt(unitBase),
      punit: usePartner ? fmt(partnerUnit) : '',
      pNoVat: usePartner ? fmt(partnerSubtotal) : '',
      pWithVat: usePartner ? fmt(partnerWithVat) : '',
      disc: (lineDisc > 0 ? Math.round(lineDisc*100) : 0) + '%',
      noVat: fmt(subtotal),
      withVat: fmt(withVat),
    };

    const tr = document.createElement('tr');
    tr.innerHTML = cols.map(c => `<td class="${c.cls||''}">${row[c.k] ?? ''}</td>`).join('');
    tbody.appendChild(tr);
  });

  // –ü–µ—Ä–µ—Ä–∏—Å—É–µ–º –ø–æ–¥–≤–∞–ª (–∫–æ–º–ø–∞–∫—Ç–Ω–æ, –±–µ–∑ –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏—Ö –∫–æ–ª–æ–Ω–æ–∫)
  const tfootHTML = `
    <tr>
      <td colspan="${cols.length}">
        <div style="display:flex;flex-wrap:wrap;gap:14px;justify-content:flex-end;align-items:center">
          <div><span class="muted">–ò—Ç–æ–≥–æ –±–µ–∑ –ù–î–°:</span> <span class="mono" id="sumNoVAT">‚Äî</span></div>
          <div><span class="muted">–ò—Ç–æ–≥–æ —Å –ù–î–°:</span> <span class="mono" id="sumWithVAT">‚Äî</span></div>
        </div>
      </td>
    </tr>
  `;
  if (table.tFoot) table.tFoot.innerHTML = tfootHTML;

  // –ó–∞–ø–∏—à–µ–º –∏—Ç–æ–≥–∏
  document.getElementById('sumNoVAT').textContent = fmt(totals.sumNoVAT);
  document.getElementById('sumWithVAT').textContent = fmt(totals.sumWithVAT);
}


function computePartnerProfit(totals) {
  const licenseType = document.getElementById('licenseType').value;

  const diffY1 = totals.sumWithVAT - totals.sumWithVATPartner;

  let diffY2Y3;
  if (licenseType === 'perpetual') {
    const diffSupport = totals.supportFullWithVAT - totals.supportPartnerWithVAT;
    diffY2Y3 = 2 * diffSupport;
  } else {
    const withoutImplFull = totals.sumWithVAT - totals.implFullWithVAT;
    const withoutImplPartner = totals.sumWithVATPartner - totals.implPartnerWithVAT;
    const diffWithoutImpl = withoutImplFull - withoutImplPartner;
    diffY2Y3 = 2 * diffWithoutImpl;
  }

  const profitY1 = diffY1;
  const profitY3 = diffY1 + diffY2Y3;

  return {profitY1, profitY3};
}

function recalc() {
  try{syncDiscountUI();}catch(e){}
  const items = buildItems();
  const totals = computeTotals(items);
  
  try {
    const hs = document.getElementById('supportAfterHint');
    const hi = document.getElementById('implAfterHint');
    const dSup = getDisc('discSupport','useSupportDiscount');
    const dImp = getDisc('discImpl','useImplDiscount');
    if (hs) hs.textContent = dSup>0 ? ('–¢–ü –ø–æ—Å–ª–µ —Å–∫–∏–¥–∫–∏: ' + Math.round(totals.supportFullWithVAT).toLocaleString('ru-RU') + ' ‚ÇΩ —Å –ù–î–°') : '';
    if (hi) hi.textContent = dImp>0 ? ('–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–∫–∏–¥–∫–∏: ' + Math.round(totals.implFullWithVAT).toLocaleString('ru-RU') + ' ‚ÇΩ —Å –ù–î–°') : '';
  } catch(e) {}
renderTable(items, totals);

  // show/hide optional columns based on selected discounts
  try{updateColumns();}catch(e){}

  document.getElementById('kpiCost').textContent = fmt(totals.sumWithVAT);
  document.getElementById('supportCost').textContent = fmt(totals.supportFullWithVAT);
  const prof = computePartnerProfit(totals);
  document.getElementById('kpiPartnerProfit').textContent = `–ì–æ–¥ 1: ${fmt(prof.profitY1)} ¬∑ 3 –≥–æ–¥–∞: ${fmt(prof.profitY3)}`;
  try{updateROI(totals);}catch(e){}
}

// listeners for live recalc
function toISODate(d){
  const y = d.getFullYear();
  const m = String(d.getMonth()+1).padStart(2,'0');
  const day = String(d.getDate()).padStart(2,'0');
  return `${y}-${m}-${day}`;
}

function fmtRuDate(iso){
  if(!iso) return '‚Äî';
  const [y,m,d] = iso.split('-').map(Number);
  if(!y||!m||!d) return '‚Äî';
  return `${String(d).padStart(2,'0')}.${String(m).padStart(2,'0')}.${y}`;
}

function updatePaymentTerms(){
  const ship = document.getElementById('shipDate')?.value || '';
  const delay = parseInt(document.getElementById('payDelay')?.value || '0', 10);

  const payTermText = document.getElementById('payTermText');
  if (payTermText) payTermText.textContent = delay ? `–û—Ç—Å—Ä–æ—á–∫–∞ ${delay} –¥–Ω–µ–π` : '‚Äî';

  const out = document.getElementById('expectedPayDate');
  if(!out){ return; }

  if(!ship || !delay){
    out.textContent = '‚Äî';
    return;
  }

  const base = new Date(ship + 'T00:00:00');
  if(Number.isNaN(base.getTime())){
    out.textContent = '‚Äî';
    return;
  }
  base.setDate(base.getDate() + delay);
  out.textContent = fmtRuDate(toISODate(base));
}

function initPaymentTermsUI(){
  const cb = document.getElementById('showPaymentTerms');
  const card = document.getElementById('paymentTermsCard');
  if(!cb || !card) return;

  cb.addEventListener('change', ()=>{
    card.classList.toggle('show', cb.checked);
    updatePaymentTerms();
  });

  ['shipDate','payDelay'].forEach(id=>{
    const el = document.getElementById(id);
    if(!el) return;
    el.addEventListener('change', updatePaymentTerms);
    el.addEventListener('input', updatePaymentTerms);
  });

  // default ship date = today (–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏)
  const shipEl = document.getElementById('shipDate');
  if(shipEl && !shipEl.value){
    const today = new Date();
    shipEl.value = toISODate(today);
  }

  updatePaymentTerms();
}

function initListeners(){
  // –±–∞–∑–æ–≤—ã–µ –ø–æ–ª—è
  ['endpoints','partnerDiscount','partnerName','validUntil','discModules','showROI'].forEach(id=>{
    const el = document.getElementById(id);
    if(!el) return;
    el.addEventListener('input', recalc);
    el.addEventListener('change', recalc);
  });

  // —Å–µ–ª–µ–∫—Ç—ã/—á–µ–∫–±–æ–∫—Å—ã –≤–ª–∏—è—é—â–∏–µ –Ω–∞ —Ä–∞—Å—á—ë—Ç
  ['licenseType','supportTier','implOn','useSupportDiscount','useImplDiscount'].forEach(id=>{
    const el = document.getElementById(id);
    if(!el) return;
    el.addEventListener('change', ()=>{
      // –ø–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –ø–æ–ª—è —Å–∫–∏–¥–æ–∫ –ø–æ —á–µ–∫–±–æ–∫—Å–∞–º
      try{syncDiscountUI();}catch(e){}
      recalc();
    });
  });

  // —Å–∞–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è —Å–∫–∏–¥–æ–∫ (–∫–æ–≥–¥–∞ –ø–æ–ª–µ –≤–∏–¥–Ω–æ)
  ['discSupport','discImpl'].forEach(id=>{
    const el = document.getElementById(id);
    if(!el) return;
    el.addEventListener('input', recalc);
    el.addEventListener('change', recalc);
  });

  document.getElementById('btnRecalc')?.addEventListener('click', recalc);

  // –ø–µ—Ä–≤–∏—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–æ–ª–µ–π —Å–∫–∏–¥–æ–∫
  try{syncDiscountUI();}catch(e){}

  try{ initPaymentTermsUI(); }catch(e){}
}


function valOrDash(id){ const el=document.getElementById(id); return el && 'value' in el ? (el.value||'‚Äî') : '‚Äî'; }
function setupPDF() {
  document.getElementById('btnPDF').addEventListener('click', async () => {
    try {
      const printHost = document.getElementById('printDoc');
      printHost.innerHTML = '';
      const page = document.createElement('div');
      page.className = 'a3page';
      page.style.backgroundImage = "url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAACAAAAAEmCAYAAAD2ynDIAAAAAXNSR0IArs4c6QAAIABJREFUeF7t3XuYpVddJ/q1dl06nXQihCSgcjmKiI7j4GCjId3pqnenY+f0nAgINiMXCSOZMKOoIA7CCAIiN0UH5CJ3BUWJDMLotDTdXbuqE5qBaRznGJHL0eMFhkM6BEjn0l3VtdfpTTqZhKpK78v77st6P/08PPzRa/3W+/v81u48VfWtvWPwhwABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEJh4gTjxHWiAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQCAIALgEBAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEMhAQAAggyFqgQABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQICAC4AwQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAIAMBAYAMhqgFAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECAgAOAOECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBDAQEADIYohYIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgIAAgDtAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQyEBAAyGCIWiBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgIA7gABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEMhAQAAggyFqgQABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQICAC4AwQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAIAMBAYAMhqgFAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECAgAOAOECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBDAQEADIYohYIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgIAAgDtAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQyEBAAyGCIWiBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgIA7gABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEMhAQAAggyFqgQABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQICAC4AwQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAIAMBAYAMhqgFAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECAgAOAOECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBDAQEADIYohYIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgIAAgDtAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQyEBAAyGCIWiBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgIA7gABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEMhAQAAggyFqgQABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQICAC4AwQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAIAMBAYAMhqgFAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECAgAOAOECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBDAQEADIYohYIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgIAAgDtAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQyEBAAyGCIWiBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgIA7gABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEMhAQAAggyFqgQABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQICAC4AwQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAIAMBAYAMhqgFAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECAgAOAOECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBDAQEADIYohYIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgIAAgDtAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQyEBAAyGCIWiBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgIA7gABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEMhAQAAggyFqgQABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQICAC4AwQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAIAMBAYAMhqgFAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECAgAOAOECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBDAQEADIYohYIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgIAAgDtAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQyEBAAyGCIWiBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgIA7gABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEMhAQAAggyFqgQABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQICAC4AwQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAIAMBAYAMhqgFAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECAgAOAOECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBDAQEADIYohYIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgIAAgDtAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQyEBAAyGCIWiBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgIA7gABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEMhAQAAggyFqgQABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQICAC4AwQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAIAMBAYAMhqgFAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECAgAOAOECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBDAQEADIYohYIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgIAAgDtAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQyEBAAyGCIWiBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgIA7gABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEMhAQAAggyFqgQABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQICAC4AwQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAIAMBAYAMhqgFAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECAgAOAOECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBDAQEADIYohYIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgIAAgDtAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQyEBAAyGCIWiBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgIA7gABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEMhAQAAggyFqgQABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQICAC4AwQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAIAMBAYAMhqgFAgQIECBAgAABAv0I7N+//1tmZ2e/s9FozPazv5c9J0+eXN20adNfX3LJJXf0sm+Ia2Or1Xrg9PT0w6o+8+TJk7cVRXFDt+ccOXJk5tixYw+fnp7+lm73WNe9wMmTJ788Pz//jzHGdre7Dh48+PDZ2dkLul3fy7oTJ078/c6dO7/cy56c1y4tLX1/o9E4u4oejx079pe7d+8+UVbtVqu1JaX08JmZmbPKqpl7nRMnTnz15ptv/ts9e/as9ttrq9WaTik9cmZmZku/NXrc99XNmzf/v1u3bl3pcV+ly/ft23fR1NTUwzZt2tSo9KDTxW+77bbPX3HFFTcP4yxnECBAgAABAgQIECDQm4AAQG9eVhMgQIAAAQIECBDIRmBxcfGxKaVXppS+reqmYoxfbzQaT52bm/t81Wf1U//IkSNnHzt27HUppWY/+3vZE2P8q1MBgCd1u6fVal2QUnptCGFbt3us614gxvjeTZs2va6XcMrBgwdfHWN8QvendL8yxrgQQnhOURQnu9+V58qlpaVHpJQ+0G63K/mB+vT09PyOHTu+VJZeJ6zQbrd/PaX0HWXVzL1O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EwCo9iUpAFCt7zhWFwAYfCoCAIMbqkCAAAECBAgQIEAgFwEBgFwmqQ8CBAgQIECAAAECPQoMMwCQUvqHqampK+fm5v6qx8ccynIBAAGAXi6aAEAvWr2vFQDo3WzSdwgADD5BAYDBDVUgQIAAAQIECBAgkIuAAEAuk9QHAQIECBAgQIAAgR4FFhcXHxNCeHFK6UE9bu11+WqM8d033njj747bW//f1cji4uLPppSe1mtjfa7/dFEUV/W5d2jb9u7du+mss876hRjj44dxaIzxA1u2bPmtrVu3rgzjvEHOWFxcfElK6f8apMaZ9qaU/mp5efkXr7jiipvPtDa3v//oRz/6iOnp6d+JMZ5bcW9vKori98o649ChQ/9sdXX1ZSGEh5VVs0Z1PlkUxc/00+/+/fu/ZXp6+jdCCI/qZ38fe5ZOnDjxqnF7bS4sLDwuxvjzIYRz+uip5y0xxhfMz8+3et5oAwECBAgQIECAAAEClQsIAFRO7AACBAgQIECAAAEC4ynQarXOmpmZOX91dXWqyiecmppaXVlZubkoiuNVnjNI7Vardb9Go1H1Dxu/8YibNm1avvjii788yPMOY29KKe7bt+/+mzdvHsoPkxqNxq3bt2//WowxDaO/Qc44fPjw+SsrK5W6rKysLN9888037dmzZ3WQZ53EvUeOHJk5duzYAxuNRqXfs7jtttu+vnv37lvKMrrhhhtmb7755geklKbLqlmXOsePHz+xa9euG/vpN6XUOHjw4IUzMzOz/ezvdU+73b7j6NGjXx2312ar1doSQuj8t6zS181dXjMzMzddcskld/TqZz0BAgQIECBAgAABAtULDOWLgurbcAIBAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEKi3gABAveevewIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBDIREAAIJNBaoMAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIE6i0gAFDv+eueAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBDIREADIZJDaIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAIF6CwgA1Hv+uidAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBTAQEADIZpDYIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAoN4CAgD1nr/uCRAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQCATAQGATAapDQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBCot4AAQL3nr3sCBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQyERAACCTQWqDAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBOotIABQ7/nrngABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQyERAAyGSQ2iBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBeqEUh0QAABA6SURBVAsIANR7/ronQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgUwEBAAyGaQ2CBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQKDeAgIA9Z6/7gkQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIEAgEwEBgEwGqQ0CBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQqLeAAEC95697AgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEMhEQAAgk0FqgwABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgTqLSAAUO/5654AAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIEMhEQAMhkkNogQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgXoLCADUe/66J0CAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAIFMBAQAMhmkNggQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECg3gICAPWev+4JECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAIBMBAYBMBqkNAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEKi3gABAveevewIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBDIREAAIJNBaoMAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIE6i0gAFDv+eueAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBDIREADIZJDaIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAIF6CwgA1Hv+uidAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBTAQEADIZpDYIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAoN4CAgD1nr/uCRAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQCATAQGATAapDQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBCot4AAQL3nr3sCBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQyERAACCTQWqDAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBOotIABQ7/nrngABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQyERAAyGSQ2iBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBegsIANR7/ronQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgUwEBAAyGaQ2CBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQKDeAgIA9Z6/7gkQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIEAgEwEBgEwGqQ0CBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQqLeAAEC95697AgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEMhEQAAgk0FqgwABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgTqLSAAUO/5654AAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIEMhEQAMhkkNogQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgXoLCADUe/66J0CAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAIFMBAQAMhmkNggQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECg3gICAPWev+4JECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAIBMBAYBMBqkNAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEKi3gABAveevewIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBDIREAAIJNBaoMAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIE6i0gAFDv+eueAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBDIREADIZJDaIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAIF6CwgA1Hv+uidAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBTAQEADIZpDYIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAoN4CAgD1nr/uCRAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQCATAQGATAapDQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBCot4AAQL3nr3sCBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQyERAACCTQWqDAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBOotIABQ7/nrngABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQyERAAyGSQ2iBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBegsIANR7/ronQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgUwEBAAyGaQ2CBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQKDeAgIA9Z6/7gkQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIEAgEwEBgEwGqQ0CBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQqLeAAEC95697AgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEMhEQAAgk0FqgwABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgTqLSAAUO/5654AAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIEMhEQAMhkkNogQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgXoLCADUe/66J0CAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAIFMBAQAMhmkNggQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECg3gICAPWev+4JECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAIBMBAYBMBqkNAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEKi3gABAveevewIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBDIREAAIJNBaoMAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIE6i0gAFDv+eueAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBDIREADIZJDaIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAIF6CwgA1Hv+uidAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBTAQEADIZpDYIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAoN4CAgD1nr/uCRAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQCATAQGATAapDQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBCot4AAQL3nr3sCBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQyERAACCTQWqDAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBOotIABQ7/nrngABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQyERAAyGSQ2iBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBegsIANR7/ronQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgUwEBAAyGaQ2CBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQKDeAgIA9Z6/7gkQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIEAgEwEBgEwGqQ0CBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQqLeAAEC95697AgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEMhEQAAgk0FqgwABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgTqLSAAUO/5654AAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIEMhEQAMhkkNogQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgXoLCADUe/66J0CAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAIFMBAQAMhmkNggQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECg3gICAPWev+4JECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAIBMBAYBMBqkNAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEKi3gABAveevewIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBDIREAAIJNBaoMAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIE6i0gAFDv+eueAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBDIREADIZJDaIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAIF6CwgA1Hv+uidAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBTAQEADIZpDYIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAoN4CAgD1nr/uCRAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQCATAQGATAapDQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBCot4AAQL3nr3sCBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQyERAACCTQWqDAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBOotIABQ7/nrngABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQyERAAyGSQ2iBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBegsIANR7/ronQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgUwEBAAyGaQ2CBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQKDeAgIA9Z6/7gkQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIEAgEwEBgEwGqQ0CBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQqLeAAEC95697AgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEMhEQAAgk0FqgwABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgTqLSAAUO/5654AAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIEMhEQAMhkkNogQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgXoL/P+Azd7Ljsc/HQAAAABJRU5ErkJggg==')";
page.style.backgroundSize = "cover";
page.style.backgroundPosition = "center";
page.style.backgroundRepeat = "no-repeat";
page.style.opacity = "1";

      const inner = document.createElement('div');
      inner.className = 'page-inner';
      const partnerDiscountNum = (parseFloat(document.getElementById('partnerDiscount').value||'0')||0);
const partnerDiscount = partnerDiscountNum.toFixed(0) + '%';
const showPartnerInPdf = !!(document.getElementById('usePartnerDiscount')?.checked && partnerDiscountNum > 0 && (document.getElementById('partnerName')?.value||'').trim());
      // Payment terms: include in PDF only when checkbox is ON
      const __payCb = document.getElementById('showPaymentTerms');
      const showPayInPdf = !!(__payCb && __payCb.checked);
      let payBlockHtml = '';
      if (showPayInPdf) {
        const shipISO = document.getElementById('shipDate')?.value || '';
        const delayVal = parseInt(document.getElementById('payDelay')?.value || '0', 10) || 0;
        const shipFmt = shipISO ? fmtRuDate(shipISO) : '‚Äî';
        let expFmt = '‚Äî';
        if (shipISO) {
          const d = new Date(shipISO + 'T00:00:00');
          d.setDate(d.getDate() + delayVal);
          expFmt = fmtRuDate(toISODate(d));
        }
        const payTxt = delayVal > 0 ? ('–æ—Ç—Å—Ä–æ—á–∫–∞ ' + delayVal + ' –¥–Ω–µ–π') : '–±–µ–∑ –æ—Ç—Å—Ä–æ—á–∫–∏';
        payBlockHtml = `
          <div class="pay-terms" style="margin-top:12px;padding:14px 16px;border:3px solid #000;border-radius:10px;background:#fff;color:#000;font-weight:700">
            <div style="font-weight:700;margin-bottom:6px">–£—Å–ª–æ–≤–∏—è –æ—Ç–≥—Ä—É–∑–∫–∏ –∏ –æ–ø–ª–∞—Ç—ã</div>
            <div style="display:flex;gap:18px;flex-wrap:wrap;font-size:16px;color:#000;font-weight:700">
              <div>üì¶ <strong>–û—Ç–≥—Ä—É–∑–∫–∞:</strong> ${escapeHtml(shipFmt)}</div>
              <div>üí≥ <strong>–£—Å–ª–æ–≤–∏—è –æ–ø–ª–∞—Ç—ã:</strong> ${escapeHtml(payTxt)}</div>
              <div>üßæ <strong>–û–∂–∏–¥–∞–µ–º–∞—è –æ–ø–ª–∞—Ç–∞:</strong> ${escapeHtml(expFmt)}</div>
            </div>
          </div>`;
      }
      const today = new Date().toLocaleDateString('ru-RU');
      const validRaw = (document.getElementById('validUntil') && document.getElementById('validUntil').value) ? new Date(document.getElementById('validUntil').value.replace(/-/g,'/')) : null;
      const validFmt = validRaw ? validRaw.toLocaleDateString('ru-RU') : '‚Äî';
      inner.innerHTML = `
        <div class="p-header">
          <div class="p-title">–ö–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ ‚Äî –ò–Ω—Ñ–µ—Ä–∏—Ç –ò–¢–ú–µ–Ω</div>
          <div style="color:#fff;font-size:14px"><img src="data:image/png;base64,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" style="height:26px;vertical-align:middle;opacity:.9"></div>
        </div>
        <div class="meta-grid">
          <div><strong>–î–∞—Ç–∞ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è:</strong> ${today}</div>
          <div><strong>–ú–µ–Ω–µ–¥–∂–µ—Ä:</strong> ${escapeHtml(document.getElementById('managerName').value||'‚Äî')}</div>
          <div><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> ${escapeHtml(document.getElementById('managerPhone').value||'‚Äî')}</div>
          <div><strong>–ö–ª–∏–µ–Ω—Ç:</strong> ${escapeHtml(valOrDash('clientName'))}</div>
          ${showPartnerInPdf ? `<div><strong>–ü–∞—Ä—Ç–Ω—ë—Ä:</strong> ${escapeHtml(valOrDash('partnerName'))}</div>
          <div><strong>–ü–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∞—è —Å–∫–∏–¥–∫–∞:</strong> ${partnerDiscount}</div>` : ``}
          <div><strong>–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ:</strong> ${escapeHtml(valOrDash('validUntil'))}</div>
        </div>
          ${payBlockHtml}
      <div class="ptable" id="pdfTableWrap"></div>
        <div class="footer-note">–û–û–û –ù–¶–ü–†‚ÄÉ‚ÄÉ–ò–Ω—Ñ–µ—Ä–∏—Ç –ò–¢–ú–µ–Ω‚ÄÉ‚ÄÉ–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ</div>
      `;
      page.appendChild(inner);
      printHost.appendChild(page);

      // Force border on KPI block (inline styles so nothing can override)
      (function(){
        try{
          const kpiBlock = page.querySelector('.kpis') || page.querySelector('#pdfTableWrap .kpis');
          if(kpiBlock){
            kpiBlock.style.border = '3px solid #22c55e';
            kpiBlock.style.borderRadius = '14px';
            kpiBlock.style.background = '#f0fdf4';
            kpiBlock.style.boxShadow = '0 0 0 3px rgba(34,197,94,.25) inset';
            kpiBlock.style.padding = '10px';
          }
        }catch(e){}
      })();

      

      const tbl = document.createElement('table');
      tbl.className = 'ptable';
tbl.style.marginTop='0px';
      tbl.innerHTML = document.getElementById('itemsTable').outerHTML;
      const wrap = document.getElementById('pdfTableWrap');
const kpiEl = document.createElement('div');
kpiEl.className = 'kpi';
kpiEl.style.margin = '1px 0 2px 0';
kpiEl.innerHTML = `<div class="label">–ó–∞—Ä–∞–±–æ—Ç–æ–∫ –ø–∞—Ä—Ç–Ω—ë—Ä–∞</div><div class="value" id="pdfProfit">‚Äî</div><div class="label" style="margin-top:8px">–°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ (—Å –ù–î–°): <span id="pdfCost">‚Äî</span></div>`;
kpiEl.style.margin='2px 0 0 0';

const __usePartner = document.getElementById('usePartnerDiscount');
const __showPartner = !!(__usePartner && __usePartner.checked);
if (__showPartner && wrap) wrap.appendChild(kpiEl);
if (wrap) wrap.appendChild(tbl);
// –∑–∞–ø–æ–ª–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ—Å–ª–µ –≤—Å—Ç–∞–≤–∫–∏
const __p = document.getElementById('kpiPartnerProfit');
const __c = document.getElementById('kpiCost');
const __pNode = document.getElementById('pdfProfit');
const __cNode = document.getElementById('pdfCost');
if (__p && __pNode) __pNode.textContent = __p.textContent;
if (__c && __cNode) __cNode.textContent = __c.textContent;
    const cmt = (document.getElementById('comment') && document.getElementById('comment').value) ? document.getElementById('comment').value : '';
    if (cmt) {
      const cdiv = document.createElement('div');
      cdiv.style.marginTop = '12px';
      cdiv.style.whiteSpace = 'pre-wrap';
      cdiv.style.fontSize = '14px';
      cdiv.style.color = '#0f172a';
      cdiv.textContent = '–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ' + cmt;
      inner.appendChild(cdiv);
    }

      const jsPDF = (window.jspdf && window.jspdf.jsPDF) ? window.jspdf.jsPDF : (window.jsPDF || null);
      if(!jsPDF) throw new Error('jsPDF –Ω–µ –Ω–∞–π–¥–µ–Ω');
      
const canvas = await html2canvas(page, {scale:3, useCORS:true, backgroundColor:'#ffffff'});

// Multi-page A3 landscape: fit width, slice by height
const pdf = new jsPDF({orientation:'landscape', unit:'pt', format:'a3'});
const pageW = pdf.internal.pageSize.getWidth();
const pageH = pdf.internal.pageSize.getHeight();

// scale image to full page width
const imgW = pageW;
const imgH = canvas.height * imgW / canvas.width;

// how much source canvas height fits one PDF page
const sliceH = Math.floor(canvas.width * pageH / imgW);

let renderedH = 0;
let pageIndex = 0;

while (renderedH < canvas.height) {
  const partCanvas = document.createElement('canvas');
  partCanvas.width = canvas.width;
  partCanvas.height = Math.min(sliceH, canvas.height - renderedH);
  const ctx = partCanvas.getContext('2d');
  ctx.drawImage(canvas, 0, renderedH, canvas.width, partCanvas.height, 0, 0, canvas.width, partCanvas.height);

  const imgData = partCanvas.toDataURL('image/png');
  if (pageIndex > 0) pdf.addPage();
  const partImgH = partCanvas.height * imgW / partCanvas.width;
  pdf.addImage(imgData, 'PNG', 0, 0, imgW, partImgH);

  renderedH += partCanvas.height;
  pageIndex += 1;
}

pdf.save('KP_ITMen_partner_profit.pdf');

    } catch(e) {
      alert('–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è PDF: ' + e.message);
      console.error(e);
    }
  });
}

function escapeHtml(str){
  const map = {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'};
  return (str||'').replace(/[&<>"']/g, s => map[s]);
}

fillSupportTiers();
initModules();
initListeners();
recalc();
setupPDF();


function toggleSimple(cbId, inputId){
  const cb=document.getElementById(cbId);
  const input=document.getElementById(inputId);
  if(!cb||!input) return;
  const box=input.closest('.discInput');
  if(cb.checked){
    if(box) box.style.display='block';
    input.disabled=false;
  } else {
    input.value='0';
    if(box) box.style.display='none';
    input.disabled=true;
  }
}
['usePartnerDiscount','useModuleDiscount'].forEach(id=>{
  const cb=document.getElementById(id);
  if(cb){
    cb.addEventListener('change',()=>{
      toggleSimple('usePartnerDiscount','partnerDiscount');
  togglePartnerExtras();
      togglePartnerExtras();
applyPartnerProfitVisibility();
            applyPartnerProfitVisibility();
toggleSimple('useModuleDiscount','discModules');
      recalc();
          try{updateColumns();}catch(e){}
});
  }
});
toggleSimple('usePartnerDiscount','partnerDiscount');
  togglePartnerExtras();
      togglePartnerExtras();
toggleSimple('useModuleDiscount','discModules');

function applyPartnerProfitVisibility(){
  const cb = document.getElementById('usePartnerDiscount');
  const on = cb ? cb.checked : false;
  document.body.classList.toggle('hidePartnerProfit', !on);
}



function toggleDiscountColumn(){
  const show = (document.getElementById('useModuleDiscount')?.checked ||
                document.getElementById('useSupportDiscount')?.checked ||
                document.getElementById('useImplDiscount')?.checked);
  const table = document.getElementById('itemsTable');
  if(!table) return;

  const ths = Array.from(table.querySelectorAll('thead th'));
  const idx = ths.findIndex(th => ((th.textContent||'').trim().toLowerCase() === '—Å–∫–∏–¥–∫–∞'));
  if(idx === -1) return;
  const col = idx + 1;

  table.querySelectorAll(`thead th:nth-child(${col}), tbody td:nth-child(${col})`).forEach(el=>{
    el.style.display = show ? '' : 'none';
  });
}

// Wrap renderTable so toggle runs after every re-render (without touching calc logic)
try{
  const __rt = renderTable;
  renderTable = function(items, totals){
    __rt(items, totals);
    toggleDiscountColumn();
  };
}catch(e){}

// Update instantly on checkbox change
['useModuleDiscount','useSupportDiscount','useImplDiscount'].forEach(id=>{
  const cb = document.getElementById(id);
  if(cb) cb.addEventListener('change', toggleDiscountColumn);
});

// Initial hide/show
toggleDiscountColumn();

function togglePartnerExtras(){
  const cb = document.getElementById('usePartnerDiscount');
  const wrap = document.getElementById('partnerNameWrap');
  const inp = document.getElementById('partnerName');
  if(!cb || !wrap) return;
  if(cb.checked){
    wrap.classList.add('show');
    if(inp) inp.disabled = false;
  } else {
    wrap.classList.remove('show');
    if(inp){ inp.value=''; inp.disabled = true; }
  }
}



function enforcePartnerPinGate(){
  const cb = document.getElementById('usePartnerDiscount');
  if(!cb) return;
  cb.addEventListener('change', ()=>{
    if(cb.checked){
      const ok = requirePartnerPin();
      if(!ok){
        cb.checked = false;
        try{ togglePartnerExtras(); }catch(err){}
        try{ recalc(); }catch(err){}
      }
    }
  });
}
enforcePartnerPinGate();
enforceOtherDiscountPinGates();
</script>
</body>
</html>
